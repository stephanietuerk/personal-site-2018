<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
  	<title>d3 | simple square grid</title> 
  	<style>
	</style>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/3.10.1/lodash.min.js" charset="utf-8"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.5/d3.min.js"</script>
	
	  
</head>
<body>
	<div id = "grid"></div>


	<!-- Page elements and content go here. -->
	<script>

	var square = 5,
	  w = 400,
	  h = 400;

	// create the svg
	var svg = d3.select('#grid').append('svg')
	  .attr({
	    width: w,
	    height: h
	  });

	// calculate number of rows and columns
	var squaresRow = _.round(w / square);
	var squaresColumn = _.round(h / square);

	var percentYes = 0.57;
	var percentNo = 0.43;

	var yesColor = "#e81d41";
	var noColor = "#406fea";

	// loop over number of columns
	_.times(squaresColumn, function(n) {

	  // create each set of rows
	  	var rows = svg.selectAll('rect' + ' .row-' + (n + 1))
    	
    	.data(d3.range(squaresRow))
    	.enter().append('rect')
    	.attr({
      		class: function(d, i) {
        	return 'square row-' + (n + 1) + ' ' + 'col-' + (i + 1);
      		},
      		id: function(d, i) {
        	return 's-' + (n + 1) + (i + 1);
      		},
		    width: square,
		    height: square,
		    x: function(d, i) {
		        return i * square;
		      },
		    y: n * square,
		    cellnum: function(d, i) {
		        return ((n*squaresColumn) + (i));
		      },
		    fill: '#cccccc',
		    stroke: '#ffffff'
		})
		.transition()
     		.delay(function(d) {
	     		//var x = this.getAttribute('x')
	     		var cell = this.getAttribute('cellnum')
	     		//var cellnum = ((y/square)*squaresColumn) + (x/square)
	     		if (cell < (percentYes * (squaresColumn * squaresRow))) {
	     			return (cell * 1);
	     		}
	     		if (cell >= (percentYes * (squaresColumn * squaresRow))) { return (((squaresRow*squaresColumn) - cell)*1);
				}
			})
	    	.style("fill", function(d, i) {
		      	var cell = this.getAttribute('cellnum')
		      	if (cell < (percentYes * (squaresColumn * squaresRow))) {
		      		return yesColor;
		      	} 
		      	else {
		      		return noColor;
				}
			})
    	});

	
	</script>	
</body>
</html>